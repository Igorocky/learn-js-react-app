- use uncurried functions everywhere
- replace a[i] with a->Js_array2.unsafe_get(i)